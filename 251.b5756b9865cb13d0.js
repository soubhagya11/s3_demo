"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[251],{90251:(k,p,s)=>{s.r(p),s.d(p,{DocumentTemplatesModule:()=>z});var j=s(36895),f=s(11210),i=s(32236),d=s(62510),u=s(15861),S=s(75875),e=s(94650),v=s(80529);let m=(()=>{class o{authService;http;constructor(n,a){this.authService=n,this.http=a}getAsync(n,a){var t=this;return(0,u.Z)(function*(){return yield t.authService.getApiCallAsync(`api/v1/documenttemplates/${n}`,!0)})()}getDocumentFromS3(n){var a=this;return(0,u.Z)(function*(){return a.http.get(n,{responseType:"arraybuffer"}).toPromise()})()}create(n,a){return new Promise((t,r)=>{const l=new FormData;a&&l.append("documentTemplateFile",a,"documentTemplateFile"),l.append("recordObj",JSON.stringify(n)),this.authService.postApiCall("api/v1/documenttemplates/",l).subscribe(c=>{t(c)},c=>{r(c)})})}static \u0275fac=function(a){return new(a||o)(e.LFG(S.e),e.LFG(v.eN))};static \u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();var O=s(48819),b=s(42786),h=s(27601),E=s(2387),D=s(56368),C=s(24929),y=s(93875),g=s(54463);const J=["templateNameInput"],N=["templateDisplayNameInput"];let M=(()=>{class o{loggerService;commonService;route;documentTemplatesService;uiUtils;templateNameInput;templateDisplayNameInput;dataJsonObj={};errorObj={};constructor(n,a,t,r,l){this.loggerService=n,this.commonService=a,this.route=t,this.documentTemplatesService=r,this.uiUtils=l,this.route.queryParams.subscribe(c=>{this.dataJsonObj.queryParamsObj={defaultView:c.default_view,selectedMenuId:c.selectedMenuId,selectedSubMenuId:c.selectedSubMenuId}})}ngOnInit(){this.initializeComponent()}initializeComponent(){this.dataJsonObj.pageName=i.hf.DOCUMENT_TEMPLATES,this.dataJsonObj.htmlPageRolesEnumValuesJson={pageEnum:i.hf,pageSettingEnum:i.AM,pageSettingFieldsEnum:i.In},this.commonService.trackView(i.sn.DOCUMENT_TEMPLATES_CREATE),this.dataJsonObj.selectedEnterpriseId=localStorage.getItem(i.BU.SELECTED_ENTERPRISE),this.dataJsonObj.isSubmitButtonDisabled=!1,this.dataJsonObj.pageTitle=this.dataJsonObj?.queryParamsObj?.selectedMenuId&&this.dataJsonObj?.queryParamsObj?.selectedSubMenuId?[{key:"COMMON_PAGE_TITLES.DOCUMENT_TEMPLATES",value:"",showSubMenuDisplayName:!0},{key:"",value:"-",showSubMenuDisplayName:!1},{key:"COMMON_BUTTONS.BUTTON_CREATE",value:"",showSubMenuDisplayName:!1}]:[{key:"COMMON_PAGE_TITLES.DOCUMENT_TEMPLATES",value:"",showSubMenuDisplayName:!1},{key:"",value:"-",showSubMenuDisplayName:!1},{key:"COMMON_BUTTONS.BUTTON_CREATE",value:"",showSubMenuDisplayName:!1}],this.dataJsonObj.inputObj={is_enabled:!0},this.dataJsonObj.selectedEnterpriseObj=this.commonService.getSelcetedEnterpriseObj(),this.dataJsonObj.inputObj.enterprise=this.dataJsonObj.selectedEnterpriseObj,this.dataJsonObj.inputObj.document_parameters=[],this.dataJsonObj.lookupCodesSearchListJSON={},this.dataJsonObj.templateParametersObj={parameter_id:1,parameter_name:"",related_question:""},this.dataJsonObj.searchTerm="",this.errorObj.templateParametersObj={}}changeInputFieldValue(n,a,t){try{t[a]=n.value}catch(r){this.loggerService.setLoggerError(this.constructor.name,"changeInputFieldValue",r)}}changeFile(n,a,t){try{this.dataJsonObj.filesObj||(this.dataJsonObj.filesObj={}),this.errorObj.filesObj||(this.errorObj.filesObj={}),n.error?this.errorObj.filesObj[a]=n.error:(this.errorObj.filesObj[a]="",this.dataJsonObj.filesObj[a]=n.target.files[0],t&&(t[a]=n.target.files[0]))}catch(r){this.loggerService.setLoggerError(this.constructor.name,"changeFile",r)}}removeFile(n){try{this.errorObj.filesObj[n]="",this.dataJsonObj.filesObj[n]=""}catch(a){this.loggerService.setLoggerError(this.constructor.name,"removeFile",a)}}cancel(){try{this.commonService.redirectToPreviousUrl()}catch(n){this.loggerService.setLoggerError(this.constructor.name,"cancel",n)}}createRecord(){try{this.dataJsonObj.inputObj.name&&this.dataJsonObj.inputObj.name.length<3||!this.templateNameInput.isValid()||!this.templateDisplayNameInput.isValid()||(this.dataJsonObj.isSubmitButtonDisabled=!0,this.dataJsonObj.imagesArray=[],this.documentTemplatesService.create({enterprise:this.dataJsonObj.inputObj.enterprise,name:this.dataJsonObj.inputObj.name,display_name:this.dataJsonObj.inputObj.display_name,document_parameters:this.dataJsonObj.inputObj.document_parameters,is_enabled:!!this.dataJsonObj.inputObj.is_enabled&&this.dataJsonObj.inputObj.is_enabled},this.dataJsonObj.filesObj&&this.dataJsonObj.filesObj.documentTemplateFile?this.dataJsonObj.filesObj.documentTemplateFile:"").then(t=>{this.uiUtils.displaytoastMessage("COMMON_TOAST_MESSAGES.TOAST_SUCCESS_CREATE"),this.commonService.redirectToPreviousUrl()},t=>{this.dataJsonObj.isSubmitButtonDisabled=!1,this.commonErrorCodes(JSON.parse(t))}))}catch(n){this.dataJsonObj.isSubmitButtonDisabled=!1,this.loggerService.setLoggerError(this.constructor.name,"createRecord",n)}}commonErrorCodes(n){const a=JSON.parse(n[i.BU.STATUS]);409===a&&(this.errorObj.error="COMMON_STATUS_CODES."+a)}static \u0275fac=function(a){return new(a||o)(e.Y36(b.m),e.Y36(O.v),e.Y36(d.gz),e.Y36(m),e.Y36(h.s))};static \u0275cmp=e.Xpm({type:o,selectors:[["app-document-templates-create"]],viewQuery:function(a,t){if(1&a&&(e.Gf(J,5),e.Gf(N,5)),2&a){let r;e.iGM(r=e.CRH())&&(t.templateNameInput=r.first),e.iGM(r=e.CRH())&&(t.templateDisplayNameInput=r.first)}},features:[e._Bn([m])],decls:44,vars:41,consts:[[1,"container-fluid"],[1,"forms-wrapper"],[1,"row","g-0"],[1,"col-md-12"],[1,"card","bdt-0"],["id","stickyHeaderID",1,"card-header","card-header-primary"],[1,"subpage-header-title","w-100",3,"pageName","pageTitle","showPageHeaderItems","showDependencySubMenu"],["id","extraPaddingBottomID",1,"card-body"],[1,"row","form-bs"],[1,"col-lg-11","col-md-10","order-md-1","order-2"],[1,"row"],[1,"col-md-4"],["disabled","true","id","documenttemplates-create-enterprisename",3,"label","value"],["autoCaseFlag","false","mandatory","true","disabled","false","id","documenttemplates-create-name",3,"minlength","maxlength","label","value","valueChange"],["templateNameInput",""],[1,"error-msg","col-md-10","text-danger","text-center","mb-0"],["autoCaseFlag","false","mandatory","true","disabled","false","id","documenttemplates-create-displayname",3,"minlength","maxlength","label","value","valueChange"],["templateDisplayNameInput",""],[1,"col-md-12","order-md-1","order-2"],["mandatory","false","disabled","false","id","enterprise-create-description",3,"label","defaultvalue","maxlength","valueChange"],[1,"col-lg-1","col-md-2","order-md-1"],[1,"d-flex","justify-content-center","w-100"],[1,"uploadicon","cursor-pointer",3,"click"],["size","12","type","file","id","documentfileid","accept",".xlsx,.xls,.pdf,.doc,.docx,.txt,.odt,.ods,.odp,.csv,.ppt,.pptx","multiple","",1,"input-file",2,"display","none",3,"change"],["templateFile",""],[1,"locatebutton","d-flex","align-items-center","justify-content-center",3,"title"],["id","create_fileclick_document_id",1,"fas","fa-file-alt","cursor-pointer"],[1,"col-md-12","text-end","mt-2","mb-2","btns-group","order-md-1","order-2"],["className","btn btn-primary btn-sm","id","treasurehunt-create-submit",1,"mgr-5",3,"label","disabled","buttonOnClick"],["className","btn btn-danger btn-sm","id","treasurehunt-create-cancel",3,"label","buttonOnClick"],[1,"error-msg","col-md-12","text-danger","text-center","mb-0","order-md-1","order-2"]],template:function(a,t){if(1&a){const r=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),e._UZ(6,"app-pageheader",6),e.qZA(),e.TgZ(7,"div",7)(8,"div",8)(9,"div",9)(10,"div",10)(11,"div",11),e._UZ(12,"app-input",12),e.ALo(13,"translate"),e.qZA(),e.TgZ(14,"div",11)(15,"app-input",13,14),e.NdJ("valueChange",function(c){return t.changeInputFieldValue(c,"name",t.dataJsonObj.inputObj)}),e.ALo(17,"translate"),e.qZA(),e.TgZ(18,"div",15),e._uU(19),e.ALo(20,"translate"),e.qZA()(),e.TgZ(21,"div",11)(22,"app-input",16,17),e.NdJ("valueChange",function(c){return t.changeInputFieldValue(c,"display_name",t.dataJsonObj.inputObj)}),e.ALo(24,"translate"),e.qZA()(),e.TgZ(25,"div",18)(26,"app-textarea",19),e.NdJ("valueChange",function(c){return t.changeInputFieldValue(c,"description",t.dataJsonObj.inputObj)}),e.ALo(27,"translate"),e.qZA()()()(),e.TgZ(28,"div",20)(29,"div",21)(30,"div",22),e.NdJ("click",function(){e.CHM(r);const c=e.MAs(32);return e.KtG(c.click())}),e.TgZ(31,"input",23,24),e.NdJ("change",function(c){return t.changeFile(c,"documentTemplateFile","")}),e.qZA(),e.TgZ(33,"div",25),e.ALo(34,"translate"),e._UZ(35,"i",26),e.qZA()()()(),e.TgZ(36,"div",27)(37,"app-button",28),e.NdJ("buttonOnClick",function(){return t.createRecord()}),e.ALo(38,"translate"),e.qZA(),e.TgZ(39,"app-button",29),e.NdJ("buttonOnClick",function(){return t.cancel()}),e.ALo(40,"translate"),e.qZA()(),e.TgZ(41,"div",30),e._uU(42),e.ALo(43,"translate"),e.qZA()()()()()()()()}2&a&&(e.xp6(6),e.Q6J("pageName",t.dataJsonObj.pageName)("pageTitle",t.dataJsonObj.pageTitle)("showPageHeaderItems",!1)("showDependencySubMenu",!1),e.xp6(6),e.s9C("label",e.lcZ(13,23,"COMMON_PAGE_TITLES.ENTERPRISE")),e.s9C("value",null==t.dataJsonObj||null==t.dataJsonObj.inputObj||null==t.dataJsonObj.inputObj.enterprise?null:t.dataJsonObj.inputObj.enterprise.short_name),e.xp6(3),e.s9C("label",e.lcZ(17,25,"WORK_SKILLS_TEMPLATES.WORK_TEMPLATE_NAME")),e.s9C("value",null==t.dataJsonObj||null==t.dataJsonObj.inputObj?null:t.dataJsonObj.inputObj.name),e.Q6J("minlength",3)("maxlength",120),e.xp6(4),e.hij(" ",e.lcZ(20,27,t.errorObj.error2)," "),e.xp6(3),e.s9C("label",e.lcZ(24,29,"COMMON_FIELDS.DISPLAY_NAME")),e.s9C("value",null==t.dataJsonObj||null==t.dataJsonObj.inputObj?null:t.dataJsonObj.inputObj.display_name),e.Q6J("minlength",3)("maxlength",120),e.xp6(4),e.s9C("label",e.lcZ(27,31,"COMMON_FIELDS.DESCRIPTION")),e.s9C("defaultvalue",null==t.dataJsonObj||null==t.dataJsonObj.inputObj?null:t.dataJsonObj.inputObj.description),e.Q6J("maxlength",2e3),e.xp6(7),e.s9C("title",e.lcZ(34,33,"DIGITAL_ASSETS.UPLOAD_DOCUMENT")),e.xp6(4),e.s9C("label",e.lcZ(38,35,"COMMON_BUTTONS.BUTTON_SUBMIT")),e.s9C("disabled",t.dataJsonObj.isSubmitButtonDisabled),e.xp6(2),e.s9C("label",e.lcZ(40,37,"COMMON_BUTTONS.BUTTON_CANCEL")),e.xp6(3),e.hij(" ",e.lcZ(43,39,t.errorObj.error)," "))},dependencies:[E.r,D.a,C.R,y.q,g.X$]})}return o})(),A=(()=>{class o{constructor(){}ngOnInit(){}static \u0275fac=function(a){return new(a||o)};static \u0275cmp=e.Xpm({type:o,selectors:[["app-document-templates-list"]],decls:0,vars:0,template:function(a,t){}})}return o})();var I=s(11709),U=s.n(I),L=s(67549),Z=s.n(L);const B=[{path:"",data:{title:"documenttemplates"},children:[{path:"documenttemplates/create",component:M,data:{object_type:i.hf.DOCUMENT_TEMPLATES,title:"Document Templates Create",pageName:i.hf.DOCUMENT_TEMPLATES,pageSetting:i.AM.ACTIONS,settingField:i.In.CREATE}},{path:"documenttemplates/list",component:A,canActivate:[f.P],data:{object_type:i.hf.DOCUMENT_TEMPLATES,title:"Document Templates List",pageName:i.hf.DOCUMENT_TEMPLATES}},{path:"documenttemplates/:id/generate-document",component:(()=>{class o{loggerService;commonService;route;documentTemplatesService;uiUtils;dataJsonObj={};errorObj={};constructor(n,a,t,r,l){this.loggerService=n,this.commonService=a,this.route=t,this.documentTemplatesService=r,this.uiUtils=l,this.route.queryParams.subscribe(c=>{this.dataJsonObj.queryParamsObj={defaultView:c.default_view,selectedMenuId:c.selectedMenuId,selectedSubMenuId:c.selectedSubMenuId}})}ngOnInit(){this.initializeComponent()}initializeComponent(){this.dataJsonObj.pageName=i.hf.DOCUMENT_TEMPLATES;const a=localStorage.getItem(i.BU.NETWORK_STATUS)===i.If.Online,t=localStorage.getItem(i.BU.S3BUCKET_URL),r=localStorage.getItem(i.BU.S3_URL)?localStorage.getItem(i.BU.S3_URL):"";this.dataJsonObj.bucketUrl=a?t&&"/"!==t?t:r:"",this.commonService.trackView(i.sn.DOCUMENT_TEMPLATES_CREATE),this.dataJsonObj.selectedEnterpriseId=localStorage.getItem(i.BU.SELECTED_ENTERPRISE),this.route.params.subscribe(l=>{this.dataJsonObj.recordId=l.id,this.getRecordById(this.dataJsonObj.recordId)})}getRecordById(n){var a=this;return(0,u.Z)(function*(){console.log("\u{1f680} ~ GenerateDocumentComponent ~ getRecordById ~ recordId:",n);try{a.dataJsonObj.recordData={},a.dataJsonObj.inputObj={};const t=yield a.documentTemplatesService.getAsync(n);console.log("\u{1f680} ~ GenerateDocumentComponent ~ getRecordById ~ selectedRecordObj:",t),a.dataJsonObj.recordData=t,a.dataJsonObj.inputObj=JSON.parse(JSON.stringify(a.dataJsonObj.recordData));const r=yield a.getDocumentDynamicData(t);console.log("\u{1f680} ~ GenerateDocumentComponent ~ getRecordById ~ documentDynamicData:",r);const l=yield a.getDocumentObj(t);console.log("\u{1f680} ~ GenerateDocumentComponent ~ getRecordById ~ documentObj:",l),r&&l&&a.updateDocumentWithDynamicData(l,r)}catch(t){console.log("\u{1f680} ~ GenerateDocumentComponent ~ getRecordById ~ err:",t),a.loggerService.setLoggerError(a.constructor.name,"getRecordById",t)}})()}getDocumentObj(n){var a=this;return(0,u.Z)(function*(){return yield a.documentTemplatesService.getDocumentFromS3(`${a.dataJsonObj.bucketUrl}${n.document_file_path}/${n.document_file_name}`)})()}getDocumentDynamicData(n){return(0,u.Z)(function*(){return"LAST WILL AND TESTAMENT"===n.name?{testator_full_name:"JOE",spouse_full_name:"MARY WORTH",successor_full_name:"BUZZ",notary_full_name:"Notary",relationship_type:"my spouse",no_of_children:"5",chidren_names:"ZOE , DOE, BUZZ, XEON and SOUND",state_name:"Minnesota",trust_name:"THE JOE AND MARY TRUST",acknowledged_date:"October 29, 2024",first_witness_full_name:"Witness 1",first_witness_address:"123 Sub Main",second_witness_full_name:"Witness 2",second_witness_address:"456 Side Street"}:"SAMPLE TRUST"===n.name?{trustName:"JOE AND MARY TRUST",organizationName:"JOE and MARY WORTH",childrenNames:"ZOE, DOE, BUZZ, XEON and SOUND",successerTrustees:"Son BUZZ, and Daughter SOUND",stateName:"Minnesota",trusteeAgeToPay:"twenty-five (25)",countyName:"Lake County",seltor1:"JOE",seltor2:"MARY WORTH",coTrustee1:"JOE",coTrustee2:"MARY WORTH",acknowledgementYear:"2024"}:void 0})()}updateDocumentWithDynamicData(n,a){return(0,u.Z)(function*(){try{const t=new(U())(n);console.log("\u{1f680} ~ GenerateDocumentComponent ~ updateDocumentWithDynamicData ~ zip:",t);const r=new(Z())(t,{paragraphLoop:!1,linebreaks:!1});console.log("\u{1f680} ~ GenerateDocumentComponent ~ updateDocumentWithDynamicData ~ doc:",r),r.render(a),r.getZip().generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"})}catch(t){throw console.log("\u{1f680} ~ GenerateDocumentComponent ~ updateDocumentWithDynamicData ~ error:",t),console.error("Error updating .docx file:",t),t}})()}static \u0275fac=function(a){return new(a||o)(e.Y36(b.m),e.Y36(O.v),e.Y36(d.gz),e.Y36(m),e.Y36(h.s))};static \u0275cmp=e.Xpm({type:o,selectors:[["app-generate-document"]],decls:4,vars:2,template:function(a,t){1&a&&(e.TgZ(0,"p"),e._uU(1," generate-document works!\n"),e.qZA(),e.TgZ(2,"span"),e._uU(3),e.qZA()),2&a&&(e.xp6(3),e.AsE("Name: ",t.dataJsonObj.recordData.name,", ID: ",t.dataJsonObj.recordData._id,""))}})}return o})(),data:{object_type:i.hf.DOCUMENT_TEMPLATES,title:"Document Templates Generate Document",pageName:i.hf.DOCUMENT_TEMPLATES}}]}];let P=(()=>{class o{static \u0275fac=function(a){return new(a||o)};static \u0275mod=e.oAB({type:o});static \u0275inj=e.cJS({imports:[d.Bz.forChild(B),d.Bz]})}return o})();var _=s(44281),F=s(32174),G=s(70057),T=s(24006),w=s(67375),Y=s(93144),W=s(3848);let z=(()=>{class o{static \u0275fac=function(a){return new(a||o)};static \u0275mod=e.oAB({type:o});static \u0275inj=e.cJS({imports:[j.ez,G.Pc,P,_.Q,g.aw,F.fx,T.UX,T.u5,w.UM,Y.U$,W.Nh]})}return o})()}}]);